function handleResize(){windowW=window.innerWidth,windowH=window.innerHeight,large_screen=!1,medium_screen=!1,small_screen=!1,windowW>=1025?large_screen=!0:windowW>=650?medium_screen=!0:windowW<650&&(small_screen=!0),small_screen?(margin.left=0,margin.right=0,mapD.w=windowW-16,mapD.h=.66*windowW,c1m.right=15,c1D.w=windowW-16-c1m.left-c1m.right,c1D.h=.66*windowW-c1m.top-c1m.bottom,smallmapD.w=windowW/2-8,smallmapD.h=windowW/2*.66,mediummapD.w=windowW-20,mediummapD.h=.66*windowW,d3.selectAll(".nomobile").style("display","none").remove(),d3.selectAll(".onlymobile").style("display","block")):medium_screen?(margin.left=.125*windowW-8,margin.right=.125*windowW-8,mapD.w=.7*windowW,mapD.h=.8*windowH,c1D.w=.75*windowW-c1m.left-c1m.right,c1D.h=.75*windowW*.66-c1m.top-c1m.bottom,smallmapD.w=.75*windowW/2,smallmapD.h=.75*windowW/2*.66,mediummapD.w=.75*windowW/2,mediummapD.h=.75*windowW/2*.66,d3.selectAll(".mobileMap0").style("display","none"),d3.selectAll(".onlymobile").style("display","block")):(margin.left=.125*windowW-8,margin.right=.125*windowW-8,mapD.w=.7*windowW,mapD.h=.8*windowH,c1D.w=.75*windowW-c1m.left-c1m.right,c1D.h=.75*windowW*.66-c1m.top-c1m.bottom,smallmapD.w=.75*windowW/4,smallmapD.h=.75*windowW/4*.66,mediummapD.w=.75*windowW/2,mediummapD.h=.75*windowW/2*.66,d3.selectAll(".mobileMap0").style("display","none")),stepHeight=Math.floor(.75*window.innerHeight),step.style("height",stepHeight+"px"),bodyWidth=d3.select("body").node().offsetWidth,textWidth=text.node().offsetWidth,graphicWidth=mapD.w,graphic.style("width",graphicWidth+"px").style("height",window.innerHeight+"px"),chartMargin=mapD.m,chartWidth=graphic.node().offsetWidth-chartMargin,chartHeight=mapD.h,chart.style("width",chartWidth+"px").style("height",chartHeight+"px"),scroller.resize(),projection=d3.geoAlbers().scale(mapD.w+100).translate([mapD.w/2,.6*mapD.h]).precision(.1),smallprojection=d3.geoAlbers().scale(smallmapD.w+75).translate([.475*smallmapD.w,.525*smallmapD.h]).precision(.1),mediumprojection=d3.geoAlbers().scale(mediummapD.w+75).translate([.475*mediummapD.w,.55*mediummapD.h]).precision(.1),path=d3.geoPath().projection(projection),smallpath=d3.geoPath().projection(smallprojection),mediumpath=d3.geoPath().projection(mediumprojection),xscale=d3.scaleTime().range([0,c1D.w]),yscale=d3.scaleLinear().range([c1D.h,0]),line=d3.line().curve(d3.curveStepAfter).x(function(t){return xscale(t.date)}).y(function(t){return yscale(t.wins)}),line.defined(function(t){return t.wins||t.wins>0}),d3.selectAll(".continent").attr("d",path),d3.selectAll(".continentSmall").attr("d",smallpath),d3.selectAll(".continentMedium").attr("d",mediumpath);for(var t=0;t<mapCount;t++)d3.select("#map"+t).attr("height",mapD.h).attr("width",mapD.w);for(var t=0;t<smallmapCount;t++)d3.select("#smallmap"+t).attr("height",smallmapD.h).attr("width",smallmapD.w).style("transform","translate("+(smallmapD.m+margin.left)+"px)");for(var t=0;t<mediummapCount;t++)d3.select("#mediummap"+t).attr("height",mediummapD.h).attr("width",mediummapD.w).style("transform","translate("+(mediummapD.m+margin.left)+"px)");d3.select("#chart1").attr("height",c1D.h+c1m.top+c1m.bottom).attr("width",c1D.w+c1m.left+c1m.right).style("transform","translate("+margin.left+"px)"),d3.select(".c1close").style("width",c1D.w+c1m.left+c1m.right+"px").style("transform","translate("+margin.left+"px)"),d3.selectAll(".overchart").style("transform","translate("+(margin.left+c1m.left)+"px)"),d3.selectAll(".mapcaptionsmall").style("left",margin.left+.25*smallmapD.w/2+"px").style("width",.75*smallmapD.w+"px"),d3.selectAll(".mapcaptionmedium").style("left",margin.left+.25*mediummapD.w/2+"px").style("width",.75*mediummapD.w+"px"),small_screen||d3.select("#chart-overtext1").style("left",margin.left+100+"px"),targetValue=sliderD.w-15,x.range([30,targetValue]),d3.select(".track").attr("x1",x.range()[0]).attr("x2",x.range()[1])}function loadData(){queue().defer(d3.json,"js/maps/world-continents.json").defer(d3.json,"js/maps/us.json").defer(d3.json,"js/maps/canada.json").defer(d3.csv,"data/data.csv").defer(d3.csv,"data/cities.csv").defer(d3.csv,"data/matrix.csv").await(processData),ipLookUp()}function processData(t,e,a,r,o,n,l){handleResize(),window.addEventListener("resize",handleResize),findClosest(n),drawMaps(e,a,r),small_screen&&drawMap0small(o),small_screen||drawMap0(o,n),drawProMaps(o),drawProVsCollegeMaps(o,n),drawChart1(l,o),drawChart2(n)}function drawMaps(t,e,a){for(var r=0;r<mapCount;r++){var o=d3.select("#map"+r),n=o.append("g").style("transform","translate("+mapD.m+","+mapD.m+")"),l=o.append("defs"),c=l.append("filter").attr("id","glow").attr("filterUnits","userSpaceOnUse");c.append("feGaussianBlur").attr("in","SourceAlpha").attr("stdDeviation","25").attr("result","blur"),c.append("feColorMatrix").attr("type","matrix").attr("values",".25 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 0.25 0 ").attr("result","bluralpha"),c.append("feOffset").attr("in","bluralpha").attr("dx",0).attr("dy",0).attr("result","offsetBlur");var s=c.append("feMerge");s.append("feMergeNode").attr("in","offsetBlur"),s.append("feMergeNode").attr("in","SourceGraphic"),n.append("path").attr("class","continent").datum(topojson.feature(t,t.objects.continent)).attr("d",path).style("fill","#fff").style("filter","url(#glow)")}for(var r=0;r<smallmapCount;r++){var o=d3.select("#smallmap"+r),n=o.append("g").attr("transform","translate("+smallmapD.m+","+smallmapD.m+")");n.append("path").attr("class","continentSmall").datum(topojson.feature(e,e.objects.states)).attr("d",smallpath).style("fill","#efefef").style("stroke","#fff"),n.append("path").attr("class","continentSmall").datum(topojson.feature(a,a.objects.canadaprov)).attr("d",smallpath).style("fill","#efefef").style("stroke","#fff")}for(var r=0;r<mediummapCount;r++){var o=d3.select("#mediummap"+r),n=o.append("g").attr("transform","translate("+mediummapD.m+","+mediummapD.m+")");n.append("path").attr("class","continentMedium").datum(topojson.feature(e,e.objects.states)).attr("d",mediumpath).style("fill","#efefef").style("stroke","#fff"),n.append("path").attr("class","continentMedium").datum(topojson.feature(a,a.objects.canadaprov)).attr("d",mediumpath).style("fill","#efefef").style("stroke","#fff")}}function drawMap0(t,e){function a(t){if("everything"===t)var e=[];if("pro"===t)var e=["MLB","NBA","NFL","NHL","CFL","MLS"];if("ncaa"==t)var e=["Baseball (M)","Basketball (M)","Basketball (W)","Football (M)","Soccer (W)","Volleyball (W)"];var a={pro:["MLB","NBA","NFL","NHL","CFL","MLS"],ncaa:["Baseball (M)","Basketball (M)","Basketball (W)","Football (M)","Soccer (W)","Volleyball (W)"]},r={pro:["baseball","basketball","american_football","ice_hockey","canadian_football","soccer"],ncaa:["baseball-men","basketball-men","basketball-women","american_football-men","soccer-women","volleyball-women"]},o=d3.selectAll(".m0filter").append("div").attr("class","m0subfilter");o.append("span").attr("class","m0subOption m0subOptionActive").attr("key",t).text("All");for(var n=0;n<a[t].length;n++)o.append("span").attr("class","m0subOption").attr("key",r[t][n]).text(a[t][n]);$(".m0subOption").click(function(){$(".m0subOption").removeClass("m0subOptionActive"),$(this).addClass("m0subOptionActive");var t=$(this).attr("key");b="pro"===t?["baseball","canadian_football","ice_hockey","american_football","basketball","soccer"]:"ncaa"===t?["american_football-men","basketball-men","baseball-men","volleyball-women","basketball-women","soccer-women"]:[t],s(x.invert(A),b,!0)})}function r(t){return t.id=t.id,t.date=parseDate(t.date),t}function o(t){t=t||window.event,"13"==t.which?map0?(map0=!1,$("#play-button").click()):(map0=!0,$("#play-button").click()):"39"==t.which?n():"37"==t.which&&l()}function n(){s(x.invert(A),b,!1),(A+=targetValue/151)>targetValue&&(w=!1,A=0,clearInterval(timer),k.text("Play"))}function l(){A-=targetValue/151,s(x.invert(A),b,!1),A>targetValue&&(w=!1,A=0,clearInterval(timer),k.text("Play"))}function c(t,e,a){a&&d3.selectAll(".city").remove();var r=[];t.forEach(function(t){r.push(t.t1loc),t.newNth=countThis(r,t.t1loc)});var o=y.selectAll(".city").data(t);o.enter().append("circle").attr("class","city").attr("cx",function(t){return h.select("."+t.trophySelector).transition().duration(250).attr("x",projection(parseCoord(t.t1coord))[0]-25).attr("y",projection(parseCoord(t.t1coord))[1]-25).style("opacity","1"),projection(parseCoord(t.t1coord))[0]}).attr("cy",function(t){return projection(parseCoord(t.t1coord))[1]}).style("fill",function(t){return t.colour}).style("opacity",function(t){return opacityScale(t.newNth)}).attr("r",0).transition().duration(400).attr("r",function(t){return t.newNth}),f.selectAll(".placeCircles").data(e).enter().append("circle").attr("class","map0city placeCircles").attr("id",function(t){return"map0place-"+camelize(t.cityState)}).attr("cx",function(t){return projection(parseCoord(t.lngLat))[0]}).attr("cy",function(t){return projection(parseCoord(t.lngLat))[1]}).attr("r",function(t){return t.count}).style("fill","#333").style("opacity",0),d3.selectAll(".placeCircles").on("mouseover",function(t){u.append("text").attr("class","cityAnnoBG cityAnno-"+camelize(t.cityState)).attr("x",projection(parseCoord(t.lngLat))[0]+8).attr("y",projection(parseCoord(t.lngLat))[1]+8).attr("text-anchor","middle").attr("dy",function(){return t.count/3*2}).text(t.city+" ("+t.count+")"),u.append("text").attr("class","mainAnno cityAnno-"+camelize(t.cityState)).attr("x",projection(parseCoord(t.lngLat))[0]+8).attr("y",projection(parseCoord(t.lngLat))[1]+8).attr("text-anchor","middle").attr("dy",function(){return t.count/3*2}).text(t.city+" ("+t.count+")")}).on("mouseout",function(t){d3.selectAll(".cityAnno-"+camelize(t.cityState)).transition().delay(200).duration(200).style("opacity",0).remove()}),o.exit().remove();for(var n={cities:["Princeton, NJ","Boston, MA","Toronto, ON","Berkeley, CA","Eugene, OR","Green Bay, WI","New York, NY","Los Angeles, CA"],coords:[[-74.6672226,40.3572976],[-71.0588801,42.3600825],[-79.3831843,43.653226],[-122.272747,37.8715926],[-123.0867536,44.0520691],[-88.0132958,44.5133188],[-74.0059728,40.7127753],[-118.2436849,34.0522342]]},l=0;l<n.cities.length;l++)u.append("text").attr("class","cityAnnoBG scrollLabel scrollLabel"+l).attr("x",projection(n.coords[l])[0]+8).attr("y",projection(n.coords[l])[1]+8).attr("text-anchor","middle").attr("dy",function(){return 20}).style("opacity",0).text(n.cities[l]),u.append("text").attr("class","mainAnno scrollLabel scrollLabel"+l).attr("x",projection(n.coords[l])[0]+8).attr("y",projection(n.coords[l])[1]+8).attr("text-anchor","middle").attr("dy",function(){return 20}).style("opacity",0).text(n.cities[l]);window.addEventListener("resize",function(){d3.selectAll(".trophy").transition().duration(100).style("opacity",0),d3.selectAll(".city").attr("cx",function(t){return projection(parseCoord(t.t1coord))[0]}).attr("cy",function(t){return projection(parseCoord(t.t1coord))[1]})}),h.selectAll(".trophy").style("opacity",0)}function s(a,r,o){L.attr("cx",x(a)),j.attr("cx",x(a)),d3.select("#sliderYear").html(formatDateIntoYear(a)),"2018"==d3.select("#sliderYear").html()&&$("#play-button").removeClass("paused").removeClass("played").addClass("ended"),parseInt(d3.select("#sliderYear").html())<2018&&d3.selectAll(".map0Annotation2018").style("opacity","0"),parseInt(d3.select("#sliderYear").html())>2017&&(d3.select(".map0Annotation2002").style("opacity","0"),d3.selectAll(".map0Annotation2018").style("opacity","1"),u.on("mouseover",function(){d3.selectAll(".map0Annotation2018").transition().duration(200).style("opacity",0)}).on("mouseout",function(){d3.selectAll(".map0Annotation2018").transition().duration(400).style("opacity",1)}));var n=t.filter(function(t){return t.year<=formatDateIntoYear(a)&&r.indexOf(t.sport)>-1});o?c(n,e,!0):c(n,e,!1)}function i(t){var e=D[t.index];s(parseYear(e),b,!1),d3.selectAll(".scrollLabel").style("opacity",0),d3.selectAll(".scrollLabel"+(t.index-1).toString()).style("opacity",1)}function d(t){}function p(t){}function m(){d3.selectAll(".sticky").each(function(){Stickyfill.add(this)})}var u=d3.select("#map0"),y=u.append("g").attr("transform","translate("+mapD.m+","+mapD.m+")"),h=u.append("g").attr("transform","translate("+mapD.m+","+mapD.m+")");u.append("g").attr("class","map0annotation-group");var f=u.append("g").attr("transform","translate("+mapD.m+","+mapD.m+")"),g=!1,b=["american_football-men","baseball","canadian_football","ice_hockey","american_football","basketball-men","basketball","baseball-men","volleyball-women","basketball-women","soccer-women","soccer"];$(".m0option").click(function(){$(".m0option").removeClass("m0optionActive"),$(this).addClass("m0optionActive"),key=$(this).attr("key"),"everything"===key&&(b=["american_football-men","baseball","canadian_football","ice_hockey","american_football","basketball-men","basketball","baseball-men","volleyball-women","basketball-women","soccer-women","soccer"]),"pro"===key&&(b=["baseball","canadian_football","ice_hockey","american_football","basketball","soccer"]),"ncaa"===key&&(b=["american_football-men","basketball-men","baseball-men","volleyball-women","basketball-women","soccer-women"]),d3.selectAll(".m0subfilter").remove(),"everything"===key?d3.selectAll(".map0Annotation2018").transition().duration(200).style("opacity",1):"pro"===key?(a(key),d3.selectAll(".map0Annotation2018").transition().duration(200).style("opacity",0)):"ncaa"===key&&(a(key),d3.selectAll(".map0Annotation2018").transition().duration(200).style("opacity",0)),s(parseYear(2018),b,!0)}),u.on("click",function(){$("#play-button").click()});for(var v=0;v<trophyList.length;v++)h.append("svg:image").attr("class","trophy trophy-"+trophyList[v]).attr("width",50).attr("height",50).attr("xlink:href","img/icons/"+trophyList[v]+".png").style("opacity",0);d3.select(".trophy-NBA").attr("x",projection([-75.1652215,39.9525839])[0]-25).attr("y",projection([-75.1652215,39.9525839])[1]-25),d3.select(".trophy-NHL").attr("x",projection([-79.3831843,43.653226])[0]-25).attr("y",projection([-79.3831843,43.653226])[1]-25),d3.select(".trophy-NFL").attr("x",projection([-81.378447,40.7989472999999])[0]-25).attr("y",projection([-81.378447,40.7989472999999])[1]-25),d3.select(".trophy-MLB").attr("x",projection([-71.0588801,42.3600825])[0]-25).attr("y",projection([-71.0588801,42.3600825])[1]-25),d3.select(".trophy-CFL").attr("x",projection([-79.3831843,43.653226])[0]-25).attr("y",projection([-79.3831843,43.653226])[1]-25),d3.select(".trophy-MLS").attr("x",projection([-77.0368707,38.9071923])[0]-25).attr("y",projection([-77.0368707,38.9071923])[1]-25),d3.select(".trophy-volleyball-w").attr("x",projection([-81.0348144,34.0007104])[0]-25).attr("y",projection([-81.0348144,34.0007104])[1]-25),d3.select(".trophy-baseball-m").attr("x",projection([-122.272747,37.8715926])[0]-25).attr("y",projection([-122.272747,37.8715926])[1]-25),d3.select(".trophy-basketball-m").attr("x",projection([-123.0867536,44.0520691])[0]-25).attr("y",projection([-123.0867536,44.0520691])[1]-25),d3.select(".trophy-basketball-w").attr("x",projection([-79.8742367999999,40.5077792])[0]-25).attr("y",projection([-79.8742367999999,40.5077792])[1]-25),d3.select(".trophy-football-m").attr("x",projection([-74.6672226,40.3572976])[0]-25).attr("y",projection([-74.6672226,40.3572976])[1]-25),d3.select(".trophy-soccer-w").attr("x",projection([-79.0558445,35.9131996])[0]-25).attr("y",projection([-79.0558445,35.9131996])[1]-25);var w=!1,A=15,k=d3.select("#play-button");x.domain([startDate,endDate]).range([15,targetValue]).clamp(!0);var C=d3.select("#slider").append("g").attr("class","sliderG").attr("transform","translate(0,"+sliderD.h/3+")");C.append("line").attr("class","track").attr("x1",x.range()[0]).attr("x2",x.range()[1]).select(function(){return this.parentNode.appendChild(this.cloneNode(!0))}).attr("class","track-inset").select(function(){return this.parentNode.appendChild(this.cloneNode(!0))}).attr("class","track-overlay").call(d3.drag().on("start.interrupt",function(){C.interrupt()}).on("start drag",function(){A=d3.event.x,s(x.invert(A),b,!1)})),C.append("text").attr("class","slider-tick").attr("x",x.range()[0]).attr("y",sliderD.h*(2/3)).attr("text-anchor","middle").attr("dy",7).text("1870"),C.append("text").attr("class","slider-tick").attr("x",x.range()[1]).attr("y",sliderD.h*(2/3)).attr("text-anchor","middle").attr("dy",7).text("2018");var L=C.insert("circle",".track-overlay").attr("class","slider-handle").attr("r",5).attr("cx",x(startDate)),j=C.insert("circle",".track-overlay").attr("class","slider-handleStroke").attr("r",7).attr("cx",x(startDate));d3.select("#sliderYear").text(formatDateIntoYear(startDate)),k.on("click",function(){var t=d3.select(this);"Pause"==t.text()?(w=!1,clearInterval(timer),t.text("Play"),$("#play-button").removeClass("played").removeClass("ended").addClass("paused")):(w=!0,timer=setInterval(n,100),t.text("Pause"),$("#play-button").removeClass("paused").removeClass("ended").addClass("played"))}),C.on("click",function(){w&&$("#play-button").click()}),document.onkeydown=o;var D=[1870,1875,1903,1918,1921,1939,1967,1985,2002,2018];scroller.setup({container:"#scroll",graphic:".scroll__graphic",text:".scroll__text",step:".scroll__text .step",debug:!1}).onStepEnter(i).onContainerEnter(d).onContainerExit(p);const N=d3.annotationCustomType(d3.annotationCalloutElbow,{connector:{type:"elbow",end:"dot"}}),M=[{note:{title:"1. Los Angeles",label:"25 PRO/39 NCAA",orientation:"leftRight",lineType:"none",align:"middle"},className:"map0hide map0Annotation annotation-start map0Annotation2018",x:projection([-118.2436849,34.0522342])[0]+8,y:projection([-118.2436849,34.0522342])[1]+8,dy:-40,dx:50},{note:{title:"2. New York",label:"54 PRO/1 NCAA",orientation:"leftRight",lineType:"none",align:"middle"},className:"map0hide map0Annotation annotation-end map0Annotation2018",x:projection([-74.0059728,40.7127753])[0]+8,y:projection([-74.0059728,40.7127753])[1]+8,dy:100,dx:-110},{note:{title:"3. Toronto",label:"40 PRO",orientation:"leftRight",lineType:"none",align:"middle"},className:"map0hide map0Annotation annotation-end map0Annotation2018",x:projection([-79.3831843,43.653226])[0]+8,y:projection([-79.3831843,43.653226])[1]+8,dy:-40,dx:-50},{note:{title:"4. Boston",label:"37 PRO",orientation:"leftRight",lineType:"none",align:"middle"},className:"map0hide map0Annotation annotation-end map0Annotation2018",x:projection([-71.0588801,42.3600825])[0]+8,y:projection([-71.0588801,42.3600825])[1]+8,dy:-30,dx:-40},{note:{title:"5. Montreal",label:"36 PRO",orientation:"leftRight",lineType:"none",align:"middle"},className:"map0hide map0Annotation annotation-end map0Annotation2018",x:projection([-73.567256,45.5016889])[0]+8,y:projection([-73.567256,45.5016889])[1]+8,dy:-40,dx:-50}],P=d3.annotation().textWrap(250).type(N).annotations(M);if(d3.select("g.map0annotation-group").call(P),void 0!=userPlace&&"Los Angeles"!=userPlace.city&&"New York"!=userPlace.city&&"Toronto"!=userPlace.city&&"Boston"!=userPlace.city&&"Montreal"!=userPlace.city){const _=[{note:{title:userPlace.rank_all+". "+userPlace.city,label:userPlace.count+" TITLES",orientation:"leftRight",lineType:"none",align:"middle"},className:"map0Annotation annotation-end map0Annotation2018 map0AnnotationCurrent",x:projection(parseCoord(userPlace.lngLat))[0]+8,y:projection(parseCoord(userPlace.lngLat))[1]+8,dy:-20,dx:-30}],B=d3.annotation().textWrap(250).type(N).annotations(_);u.append("g").attr("class","map0currentannotation-group").call(B)}}function drawMap0small(t){var e=t,a=[],r=d3.select("#map0"),o=r.append("g").attr("transform","translate("+mapD.m+","+mapD.m+")");d3.select("#play-button").style("display","none"),d3.select("#sliderYear").style("display","none"),d3.selectAll(".hide").style("display","none"),d3.selectAll(".map-footer").style("width","275px").style("min-width","275px"),o.selectAll(".cityNFL").data(e).enter().append("circle").attr("class","cityNFL").attr("cx",function(t){return projection(parseCoord(t.t1coord))[0]}).attr("cy",function(t){return projection(parseCoord(t.t1coord))[1]}).style("fill",function(t){return t.colour}).style("opacity",function(t){var e=camelize(t.t1loc);a.push(e);var r=countThis(a,e);return opacityScale(r)/2}).attr("r",function(t){var e=camelize(t.t1loc);return a.push(e),countThis(a,e)/3});for(var n={cities:["1. Los Angeles, CA","2. New York, NY","3. Toronto, ON","4. Boston, MA","5. Montreal, QC"],counts:[64,55,40,37,36],coords:[[-118.2436849,34.0522342],[-74.0059728,40.7127753],[-79.3831843,43.653226],[-71.0588801,42.3600825],[-73.567256,45.5016889]]},l=0;l<n.cities.length;l++)r.append("text").attr("class","cityAnnoBG").attr("x",projection(n.coords[l])[0]+8).attr("y",projection(n.coords[l])[1]+8).attr("text-anchor","middle").attr("dy",function(){return n.counts[l]/3*2}).text(n.cities[l]+" ("+n.counts[l]+")"),r.append("text").attr("class","mainAnno").attr("x",projection(n.coords[l])[0]+8).attr("y",projection(n.coords[l])[1]+8).attr("text-anchor","middle").attr("dy",function(){return n.counts[l]/3*2}).text(n.cities[l]+" ("+n.counts[l]+")")}function drawProMaps(t){for(var e=0;e<leagueList.length;e++){var a=leagueList[e],r=t.filter(function(t){return t.leagueLevel===a}),o=[];d3.select("#smallmap"+e).append("g").attr("transform","translate("+smallmapD.m+","+smallmapD.m+")").selectAll(".city"+a).data(r).enter().append("circle").attr("class","promapCity city"+a).attr("cx",function(t){return smallprojection(parseCoord(t.t1coord))[0]}).attr("cy",function(t){return smallprojection(parseCoord(t.t1coord))[1]}).style("fill",function(t){return t.colour}).style("opacity",function(t){var e=camelize(t.t1loc);o.push(e);var a=countThis(o,e);return opacityScale(a)/2}).attr("r",function(t){var e=camelize(t.t1loc);o.push(e);var a=countThis(o,e);return small_screen?a/3:small_screen?void 0:a/1.5})}window.addEventListener("resize",function(){d3.selectAll(".promapCity").attr("cx",function(t){return smallprojection(parseCoord(t.t1coord))[0]}).attr("cy",function(t){return smallprojection(parseCoord(t.t1coord))[1]})})}function drawProVsCollegeMaps(t,e){for(var a=0;a<levelList.length;a++){var r=levelList[a],o=t.filter(function(t){return t.level===r}),n=[],l=d3.select("#mediummap"+a),c=l.append("g").attr("transform","translate("+mediummapD.m+","+mediummapD.m+")"),s=l.append("g").attr("class","medMap"+a+"Annotations-group");c.selectAll(".city"+r).data(o).enter().append("circle").attr("class","proVsmapCity city"+r).attr("cx",function(t){return mediumprojection(parseCoord(t.t1coord))[0]}).attr("cy",function(t){return mediumprojection(parseCoord(t.t1coord))[1]}).style("fill",function(t){return t.colour}).style("opacity",function(t){var e=camelize(t.t1loc);n.push(e);var a=countThis(n,e);return opacityScale(a)/2}).attr("r",function(t){var e=camelize(t.t1loc);n.push(e);var a=countThis(n,e);return small_screen?a/5:small_screen?void 0:a/4});c.selectAll(".place"+r).data(e).enter().append("circle").attr("class","proVsmapcity place"+r).attr("id",function(t){return r+"-"+camelize(t.cityState)}).attr("cx",function(t){return mediumprojection(parseCoord(t.lngLat))[0]}).attr("cy",function(t){return mediumprojection(parseCoord(t.lngLat))[1]}).attr("r",function(t){return small_screen?t[r]/3:small_screen?void 0:t[r]/2}).style("fill","#333").style("opacity",0)}var i=d3.select("#mediummap0"),d=d3.select("#mediummap1");d3.selectAll(".placepro").on("mouseover",function(t){i.append("text").attr("class","cityAnnoBG cityAnno-"+camelize(t.cityState)).attr("x",mediumprojection(parseCoord(t.lngLat))[0]+8).attr("y",mediumprojection(parseCoord(t.lngLat))[1]+8).attr("text-anchor","middle").attr("dy",function(){return small_screen?t[r]/5*2:small_screen?void 0:t[r]/4*2}).text(t.city+" ("+t.pro+")"),i.append("text").attr("class","mainAnno cityAnno-"+camelize(t.cityState)).attr("x",mediumprojection(parseCoord(t.lngLat))[0]+8).attr("y",mediumprojection(parseCoord(t.lngLat))[1]+8).attr("text-anchor","middle").attr("dy",function(){return small_screen?t[r]/5*2:small_screen?void 0:t[r]/4*2}).text(t.city+" ("+t.pro+")"),d.append("text").attr("class","cityAnnoBG cityAnno-"+camelize(t.cityState)).attr("x",mediumprojection(parseCoord(t.lngLat))[0]+8).attr("y",mediumprojection(parseCoord(t.lngLat))[1]+8).attr("text-anchor","middle").attr("dy",function(){return small_screen?t[r]/5*2:small_screen?void 0:t[r]/4*2}).text(t.city+" ("+t.NCAA+")"),d.append("text").attr("class","mainAnno cityAnno-"+camelize(t.cityState)).attr("x",mediumprojection(parseCoord(t.lngLat))[0]+8).attr("y",mediumprojection(parseCoord(t.lngLat))[1]+8).attr("text-anchor","middle").attr("dy",function(){return small_screen?t[r]/5*2:small_screen?void 0:t[r]/4*2}).text(t.city+" ("+t.NCAA+")")}).on("mouseout",function(t){d3.selectAll(".cityAnno-"+camelize(t.cityState)).transition().delay(200).duration(200).style("opacity",0).remove()}),d3.selectAll(".placeNCAA").on("mouseover",function(t){i.append("text").attr("class","cityAnnoBG cityAnno-"+camelize(t.cityState)).attr("x",mediumprojection(parseCoord(t.lngLat))[0]+8).attr("y",mediumprojection(parseCoord(t.lngLat))[1]+8).attr("text-anchor","middle").attr("dy",function(){return small_screen?t[r]/5*2:small_screen?void 0:t[r]/4*2}).text(t.city+" ("+t.pro+")"),i.append("text").attr("class","mainAnno cityAnno-"+camelize(t.cityState)).attr("x",mediumprojection(parseCoord(t.lngLat))[0]+8).attr("y",mediumprojection(parseCoord(t.lngLat))[1]+8).attr("text-anchor","middle").attr("dy",function(){return small_screen?t[r]/5*2:small_screen?void 0:t[r]/4*2}).text(t.city+" ("+t.pro+")"),d.append("text").attr("class","cityAnnoBG cityAnno-"+camelize(t.cityState)).attr("x",mediumprojection(parseCoord(t.lngLat))[0]+8).attr("y",mediumprojection(parseCoord(t.lngLat))[1]+8).attr("text-anchor","middle").attr("dy",function(){return small_screen?t[r]/5*2:small_screen?void 0:t[r]/4*2}).text(t.city+" ("+t.NCAA+")"),d.append("text").attr("class","mainAnno cityAnno-"+camelize(t.cityState)).attr("x",mediumprojection(parseCoord(t.lngLat))[0]+8).attr("y",mediumprojection(parseCoord(t.lngLat))[1]+8).attr("text-anchor","middle").attr("dy",function(){return small_screen?t[r]/5*2:small_screen?void 0:t[r]/4*2}).text(t.city+" ("+t.NCAA+")")}).on("mouseout",function(t){d3.selectAll(".cityAnno-"+camelize(t.cityState)).transition().delay(200).duration(200).style("opacity",0).remove()}),i.on("mouseover",function(){d3.selectAll(".medMap0Hide").transition().duration(200).style("opacity",0)}).on("mouseout",function(){d3.selectAll(".medMap0Hide").transition().duration(400).style("opacity",1)}),d.on("mouseover",function(){d3.selectAll(".medMap0Hide").transition().duration(200).style("opacity",0)}).on("mouseout",function(){d3.selectAll(".medMap0Hide").transition().duration(400).style("opacity",1)});for(var p={cities:["1. New York","3. Boston","6. Los Angeles","5. Chicago"],ranks:[54,37,25,29],coords:[[-74.0059728,40.7127753],[-71.0588801,42.3600825],[-118.2436849,34.0522342],[-87.6297982,41.8781136]]},m={cities:["1. Los Angeles","2. Chapel Hill","3. Notre Dame","3. New Haven","5. Tuscaloosa"],ranks:[39,28,18,18,15],coords:[[-118.2436849,34.0522342],[-79.0558445,35.9131996],[-86.2379328,41.7001908],[-72.9278835,41.308274],[-87.5691734999999,33.2098407]]},u={cities:["Chapel Hill","Tuscaloosa","Notre Dame"],ranks:[0,0,0],coords:[[-79.0558445,35.9131996],[-87.5691734999999,33.2098407],[-86.2379328,41.7001908]]},y={cities:["New York","Boston","Chicago"],ranks:[1,0,3],coords:[[-74.0059728,40.7127753],[-71.0588801,42.3600825],[-87.6297982,41.8781136]]},a=0;a<u.cities.length;a++)i.append("circle").attr("class","medMap0Hide").attr("cx",mediumprojection(u.coords[a])[0]+8).attr("cy",mediumprojection(u.coords[a])[1]+8).attr("r",4).style("stroke","#fff"),i.append("circle").attr("class","medMap0Hide").attr("cx",mediumprojection(u.coords[a])[0]+8).attr("cy",mediumprojection(u.coords[a])[1]+8).attr("r",4).style("fill","#b5b5b5"),d.append("circle").attr("class","medMap0Hide").attr("cx",mediumprojection(y.coords[a])[0]+8).attr("cy",mediumprojection(y.coords[a])[1]+8).attr("r",4).style("stroke","#fff"),d.append("circle").attr("class","medMap0Hide").attr("cx",mediumprojection(y.coords[a])[0]+8).attr("cy",mediumprojection(y.coords[a])[1]+8).attr("r",4).style("fill","#b5b5b5"),i.append("text").attr("class","cityAnnoBG medMap0Hide").attr("x",mediumprojection(u.coords[a])[0]+8).attr("y",mediumprojection(u.coords[a])[1]+8).attr("text-anchor","middle").attr("dy",function(){return"Notre Dame"===u.cities[a]?-13:13}).text(u.cities[a]+" ("+u.ranks[a]+")"),d.append("text").attr("class","cityAnnoBG medMap0Hide").attr("x",mediumprojection(y.coords[a])[0]+8).attr("y",mediumprojection(y.coords[a])[1]+8).attr("text-anchor","middle").attr("dy",function(){return"Chicago"===y.cities[a]||"Boston"===y.cities[a]?-13:13}).text(y.cities[a]+" ("+y.ranks[a]+")"),i.append("text").attr("class","cityAnno medMap0Hide").attr("x",mediumprojection(u.coords[a])[0]+8).attr("y",mediumprojection(u.coords[a])[1]+8).attr("text-anchor","middle").attr("dy",function(){return"Notre Dame"===u.cities[a]?-13:13}).text(u.cities[a]+" ("+u.ranks[a]+")"),d.append("text").attr("class","cityAnno medMap0Hide").attr("x",mediumprojection(y.coords[a])[0]+8).attr("y",mediumprojection(y.coords[a])[1]+8).attr("text-anchor","middle").attr("dy",function(){return"Chicago"===y.cities[a]||"Boston"===y.cities[a]?-13:13}).text(y.cities[a]+" ("+y.ranks[a]+")");for(var a=0;a<p.cities.length;a++)i.append("text").attr("class","mainAnnoBG medMap0Hide").attr("x",mediumprojection(p.coords[a])[0]+8).attr("y",mediumprojection(p.coords[a])[1]+8).attr("text-anchor","middle").attr("dy",p.ranks[a]/4*2).text(p.cities[a]+" ("+p.ranks[a]+")"),i.append("text").attr("class","mainAnno medMap0Hide").attr("x",mediumprojection(p.coords[a])[0]+8).attr("y",mediumprojection(p.coords[a])[1]+8).attr("text-anchor","middle").attr("dy",p.ranks[a]/4*2).text(p.cities[a]+" ("+p.ranks[a]+")");for(var a=0;a<m.cities.length;a++)d.append("text").attr("class","mainAnnoBG medMap0Hide").attr("x",mediumprojection(m.coords[a])[0]+8).attr("y",mediumprojection(m.coords[a])[1]+8).attr("text-anchor","middle").attr("dy",m.ranks[a]/4*2).text(m.cities[a]+" ("+m.ranks[a]+")"),d.append("text").attr("class","mainAnno medMap0Hide").attr("x",mediumprojection(m.coords[a])[0]+8).attr("y",mediumprojection(m.coords[a])[1]+8).attr("text-anchor","middle").attr("dy",m.ranks[a]/4*2).text(m.cities[a]+" ("+m.ranks[a]+")");void 0!=userPlace&&"Los Angeles"!=userPlace.city&&"New York"!=userPlace.city&&"Boston"!=userPlace.city&&"Chapel Hill"!=userPlace.city&&"Tuscaloosa"!=userPlace.city&&"Notre Dame"!=userPlace.city&&(i.append("circle").attr("class","medMap0Hide").attr("cx",mediumprojection(parseCoord(userPlace.lngLat))[0]+8).attr("cy",mediumprojection(parseCoord(userPlace.lngLat))[1]+8).attr("r",4).style("fill","#b5b5b5"),d.append("circle").attr("class","medMap0Hide").attr("cx",mediumprojection(parseCoord(userPlace.lngLat))[0]+8).attr("cy",mediumprojection(parseCoord(userPlace.lngLat))[1]+8).attr("r",4).style("fill","#b5b5b5"),i.append("text").attr("class","cityAnnoBG medMap0Hide").attr("x",mediumprojection(parseCoord(userPlace.lngLat))[0]+8).attr("y",mediumprojection(parseCoord(userPlace.lngLat))[1]+8).attr("text-anchor","middle").attr("dy",13).text(userPlace.city+" ("+userPlace.count+")"),d.append("text").attr("class","cityAnnoBG medMap0Hide").attr("x",mediumprojection(parseCoord(userPlace.lngLat))[0]+8).attr("y",mediumprojection(parseCoord(userPlace.lngLat))[1]+8).attr("text-anchor","middle").attr("dy",13).text(userPlace.city+" ("+userPlace.NCAA+")"),i.append("text").attr("class","cityAnno medMap0Hide").attr("x",mediumprojection(parseCoord(userPlace.lngLat))[0]+8).attr("y",mediumprojection(parseCoord(userPlace.lngLat))[1]+8).attr("text-anchor","middle").attr("dy",13).text(userPlace.city+" ("+userPlace.count+")"),
d.append("text").attr("class","cityAnno medMap0Hide").attr("x",mediumprojection(parseCoord(userPlace.lngLat))[0]+8).attr("y",mediumprojection(parseCoord(userPlace.lngLat))[1]+8).attr("text-anchor","middle").attr("dy",13).text(userPlace.city+" ("+userPlace.NCAA+")")),window.addEventListener("resize",function(){d3.selectAll(".proVsmapCity").attr("cx",function(t){return mediumprojection(parseCoord(t.t1coord))[0]}).attr("cy",function(t){return mediumprojection(parseCoord(t.t1coord))[1]})})}function drawChart1(t,e){function a(t){d3.selectAll(".c1labels").transition().duration(200).style("opacity",0);var e=d3.select("#chart1-"+camelize(t));large_screen?(d3.selectAll(".cityline").transition().duration(200).style("stroke-width",1).style("opacity",.2).style("stroke","#555"),e.transition().duration(200).style("stroke","#fff").style("stroke-width",2).style("opacity",.75),e.moveToFront()):(d3.selectAll(".cityline").style("stroke-width",1).style("opacity",.2).style("stroke","#555"),e.style("stroke","#fff").style("stroke-width",2).style("opacity",.75),e.moveToBack())}function r(){d3.selectAll(".c1labels").transition().duration(200).style("opacity",1),large_screen?(d3.selectAll(".cityline").transition().duration(200).style("stroke-width",1).style("opacity",.5).style("stroke","#555"),d3.selectAll("#chart1-losAngelesCA, #chart1-newYorkNY, #chart1-torontoON, #chart1-bostonMA, #chart1-montrealQC").transition().duration(200).style("stroke","#fff").style("stroke-width",2).style("opacity",.75)):(d3.selectAll(".cityline").style("stroke-width",1).style("opacity",.5).style("stroke","#555"),d3.selectAll("#chart1-losAngelesCA, #chart1-newYorkNY, #chart1-torontoON, #chart1-bostonMA, #chart1-montrealQC").style("stroke","#fff").style("stroke-width",2).style("opacity",.75))}function o(t){d3.select(".c1close").style("opacity",1),d3.selectAll(".c1labels").transition().duration(200).style("opacity",0);var e=d3.select("#chart1-"+camelize(t));large_screen?(d3.selectAll(".cityline").transition().duration(200).style("stroke-width",1).style("opacity",.2).style("stroke","#555"),e.transition().duration(200).style("stroke","#fff").style("stroke-width",2).style("opacity",.75),e.moveToFront()):(d3.selectAll(".cityline").style("stroke-width",1).style("opacity",.2).style("stroke","#555"),e.style("stroke","#fff").style("stroke-width",2).style("opacity",.75),e.moveToBack()),p.on("mouseover",function(){}).on("mouseout",function(){}),A.selectAll("path").on("mouseover",function(){}).on("mouseout",function(){}),d3.selectAll(".vor-"+camelize(t)).on("mouseover",l),d3.selectAll(".c1searchsubmitIcon").html('<i id="c1searchsubmit" class="fas fa-times"></i>').on("click",n)}function n(){d=!1,d3.select(".c1close").style("opacity",0),$("#c1search").val(""),large_screen?(d3.selectAll(".cityline").transition().duration(200).style("stroke-width",1).style("opacity",.5).style("stroke","#555"),d3.selectAll("#chart1-losAngelesCA, #chart1-newYorkNY, #chart1-torontoON, #chart1-bostonMA, #chart1-montrealQC").transition().duration(200).style("stroke","#fff").style("stroke-width",2).style("opacity",.75),b.attr("transform","translate(-100,-100)")):(d3.selectAll(".cityline").style("stroke-width",1).style("opacity",.5).style("stroke","#555"),d3.selectAll("#chart1-losAngelesCA, #chart1-newYorkNY, #chart1-torontoON, #chart1-bostonMA, #chart1-montrealQC").style("stroke","#fff").style("stroke-width",2).style("opacity",.75),b.attr("transform","translate(-100,-100)")),p.on("mouseover",function(){d3.selectAll(".c1labels").transition().duration(200).style("opacity",0)}).on("mouseout",function(){d3.selectAll(".c1labels").transition().duration(200).style("opacity",1)}),A.selectAll("path").on("mouseover",l).on("mouseout",c),d3.select(".c1searchsubmitIcon").html('<i id="c1searchsubmit" class="fas fa-search"></i>').on("click",function(){})}function l(t){if(large_screen){d3.selectAll(".cityline").transition().duration(200).style("stroke-width",1).style("opacity",.5).style("stroke","#555");var a=d3.select("#chart1-"+camelize(t.data.city));a.transition().duration(200).style("stroke","#fff").style("stroke-width",2).style("opacity",.75)}else{d3.selectAll(".cityline").style("stroke-width",1).style("opacity",.5).style("stroke","#555");var a=d3.select("#chart1-"+camelize(t.data.city));a.style("stroke","#fff").style("stroke-width",2).style("opacity",.75)}var r=e.filter(function(e){return camelize(e.t1cityState)===camelize(t.data.city)&&e.year===formatDateIntoYear(t.data.date)}),o=[],n=[];r.forEach(function(t){o.push(t.t1),n.push(t.leagueLevel)});var l="start";d3.mouse(this)[0]<=c1D.w/10&&(l="start"),d3.mouse(this)[0]>c1D.w/10&&d3.mouse(this)[0]<.9*c1D.w&&(l="middle"),d3.mouse(this)[0]>=.9*c1D.w&&(l="end"),b.attr("transform","translate("+xscale(t.data.date)+","+yscale(t.data.wins)+")"),n.length>0?b.select("circle").style("fill",cLeagues[n[0].toLowerCase()]):b.select("circle").style("fill","#fff"),b.select(".focustext").text(t.data.city+" - "+formatDateIntoYear(t.data.date)+" ("+t.data.wins+")").style("text-anchor",l),b.select(".focustextBG").text(t.data.city+" - "+formatDateIntoYear(t.data.date)+" ("+t.data.wins+")").style("text-anchor",l).style("fill","none").style("stroke","#333").style("stroke-width",6),d3.selectAll(".subFocus").remove();for(var c=0;c<o.length;c++)b.append("text").attr("class","subFocus").attr("dy",15*c+40).text(o[c]).style("text-anchor",l).style("stroke","#333").style("stroke-width",6),b.append("text").attr("class","subFocus").attr("dy",15*c+40).text(o[c]).style("fill",cLeagues[n[c].toLowerCase()]).style("text-anchor",l)}function c(t){large_screen?(d3.selectAll(".cityline").transition().duration(200).style("stroke-width",1).style("opacity",.5).style("stroke","#555"),d3.selectAll("#chart1-losAngelesCA, #chart1-newYorkNY, #chart1-torontoON, #chart1-bostonMA, #chart1-montrealQC").transition().duration(200).style("stroke","#fff").style("stroke-width",2).style("opacity",.75),b.attr("transform","translate(-100,-100)")):(d3.selectAll(".cityline").style("stroke-width",1).style("opacity",.5).style("stroke","#555"),d3.selectAll("#chart1-losAngelesCA, #chart1-newYorkNY, #chart1-torontoON, #chart1-bostonMA, #chart1-montrealQC").style("stroke","#fff").style("stroke-width",2).style("opacity",.75),b.attr("transform","translate(-100,-100)"))}var s=new Date(1870,0,1),i=new Date(2018,11,31),d=!1,p=d3.select("#chart1"),m=p.append("g").attr("transform","translate("+c1m.left+","+c1m.top+")");p.on("mouseover",function(){d3.selectAll(".c1labels").transition().duration(200).style("opacity",0)}).on("mouseout",function(){d3.selectAll(".c1labels").transition().duration(200).style("opacity",1)}).on("click",function(){n()});var u=t.columns.slice(1).map(function(e){return{id:e,values:t.filter(function(t){return!isNaN(+t[e])}).map(function(t){return{date:parseYear(t.date),wins:+t[e],city:e}})}}),y={data:searchArray,list:{maxNumberOfElements:5,sort:{enabled:!0},match:{enabled:!0},onClickEvent:function(){term=$("#c1search").val(),o(term)},onKeyEnterEvent:function(){term=$("#c1search").val(),o(term)}}},h={data:searchArray,list:{maxNumberOfElements:5,sort:{enabled:!0},match:{enabled:!0},onClickEvent:function(){term=$("#c1search2").val(),o(term)},onKeyEnterEvent:function(){term=$("#c1search2").val(),o(term)}}};$("#c1search").easyAutocomplete(y),$("#c1search2").easyAutocomplete(h),d3.select("#c1LA").on("mouseover",function(){a("losAngelesCA")}).on("mouseout",function(){d||r()}).on("click",function(){o("losAngelesCA"),d=!0,$("#c1search2").val("Los Angeles, CA"),$("#c1search").val("Los Angeles, CA")}),d3.select("#c1Philly").on("mouseover",function(){a("philadelphiaPA")}).on("mouseout",function(){d||r()}).on("click",function(){o("philadelphiaPA"),d=!0,$("#c1search2").val("Philadelphia, PA"),$("#c1search").val("Philadelphia, PA")}),d3.select("#c1BatonRouge").on("mouseover",function(){a("batonRougeLA")}).on("mouseout",function(){d||r()}).on("click",function(){o("batonRougeLA"),d=!0,$("#c1search2").val("Baton-Rouge, LA"),$("#c1search").val("Baton-Rouge, LA")}),d3.select("#c1NewHaven").on("mouseover",function(){a("newHavenCT")}).on("mouseout",function(){d||r()}).on("click",function(){o("newHavenCT"),d=!0,$("#c1search2").val("New Haven, CT"),$("#c1search").val("New Haven, CT")}),d3.select("#c1CollegeStation").on("mouseover",function(){a("collegeStationTX")}).on("mouseout",function(){d||r()}).on("click",function(){o("collegeStationTX"),d=!0,$("#c1search2").val("College Station, CT"),$("#c1search").val("College Station, CT")}),xscale.domain(d3.extent(t,function(t){return parseYear(t.date)})),yscale.domain([d3.min(u,function(t){return d3.min(t.values,function(t){return t.wins})}),d3.max(u,function(t){return d3.max(t.values,function(t){return t.wins})})]);var f=d3.voronoi().x(function(t){return xscale(t.date)}).y(function(t){return yscale(t.wins)}).extent([[-c1m.left,-c1m.top],[c1D.w+c1m.right,c1D.h+c1m.bottom]]),x=d3.axisBottom(xscale).tickSize(0).tickFormat(function(t){return formatDateIntoYear(t)}).tickValues([parseYear(1870),parseYear(1900),parseYear(1930),parseYear(1960),parseYear(1990),parseYear(2018)]),g=d3.axisLeft(yscale).tickSize(-c1D.w).tickFormat(function(t){return 60===t?t+" titles":t}).tickValues([10,20,30,40,50,60]);m.append("g").attr("class","axis xAxis").attr("transform","translate(0,"+parseInt(c1D.h)+")").call(x).selectAll("text").attr("dy",10),m.append("g").attr("class","axis yAxis").call(g).selectAll("text").attr("dy",-4).attr("dx",2).attr("text-anchor","start"),m.selectAll(".citylineG").data(u).enter().append("g").attr("class","citylineG").append("path").attr("class","cityline").attr("id",function(t){return"chart1-"+camelize(t.id)}).attr("d",function(t){return line(t.values)});var b=m.append("g").attr("transform","translate(-100,-100)").attr("class","focus");b.append("circle").attr("r",3.5).style("fill","#fff"),b.append("text").attr("class","focustextBG").attr("y",25),b.append("text").attr("class","focustext").attr("y",25);for(var v={cities:["Los Angeles, CA","New York, NY","Toronto, ON","Boston, MA","Montreal, QC"],coords:[[2014,64],[2012,55],[2017,40],[2017,37],[2006,34]]},w=0;w<5;w++)m.append("circle").attr("class","c1labels").attr("r",2).attr("cx",xscale(parseYear(v.coords[w][0]))).attr("cy",yscale(v.coords[w][1])).style("fill","#fff").style("opacity",.75),m.append("text").attr("class","c1labels").attr("x",xscale(parseYear(v.coords[w][0]))).attr("y",yscale(v.coords[w][1])).attr("dx",-10).attr("dy",5).text(v.cities[w]);var A=m.append("g").attr("class","voronoi");A.selectAll("path").data(f.polygons(d3.merge(u.map(function(t){return t.values})))).enter().append("path").attr("class",function(t){if(void 0!=t)return"vor-"+camelize(t.data.city)}).attr("d",function(t){return t?"M"+t.join("L")+"Z":null}).on("mouseover",l).on("click",l).on("mouseout",c)}function drawChart2(t){function e(t,e,o){if("pro"===t){var n=d3.selectAll(".c2filter").append("div").attr("class","c2subfilter");n.append("span").attr("class","c2subOption c2subOptionActive").attr("key","pro").text("All");for(var l=0;l<p.professional.length;l++)n.append("span").attr("class","c2subOption").attr("key",e[l]).text(p.professional[l]);$(".c2subOption").click(function(){if($(".c2subOption").removeClass("c2subOptionActive"),$(this).addClass("c2subOptionActive"),t=$(this).attr("key"),"pro"===t&&$("#chart2headertext").text("Pro Sports"),"mlb"===t&&$("#chart2headertext").text("Pro Baseball"),"nba"===t&&$("#chart2headertext").text("Pro Basketball"),"nfl"===t&&$("#chart2headertext").text("Pro Football"),"nhl"===t&&$("#chart2headertext").text("Pro Hockey"),"mls"===t&&$("#chart2headertext").text("Pro Soccer"),"cfl"===t&&$("#chart2headertext").text("Canadian Football"),d3.selectAll(".c2remove").remove(),"pro"!=t)var n=[t];if("pro"===t)var n=e;a(t,n,o),r(c,t,n,o,!1)})}if("ncaa"===t){var n=d3.selectAll(".c2filter").append("div").attr("class","c2subfilter");n.append("span").attr("class","c2subOption c2subOptionActive").attr("key","ncaa").text("All");for(var l=0;l<p.college.length;l++)n.append("span").attr("class","c2subOption").attr("key",e[l]).text(p.college[l]);$(".c2subOption").click(function(){if($(".c2subOption").removeClass("c2subOptionActive"),$(this).addClass("c2subOptionActive"),t=$(this).attr("key"),"ncaa"===t&&$("#chart2headertext").text("College Sports"),"ncaa-baseball-m"===t&&$("#chart2headertext").html("Men&rsquo;s College Baseball"),"ncaa-basketball-m"===t&&$("#chart2headertext").html("Men&rsquo;s College Basketball"),"ncaa-basketball-w"===t&&$("#chart2headertext").html("Women&rsquo;s College Basketball"),"ncaa-football-m"===t&&$("#chart2headertext").html("Men&rsquo;s College Football"),"ncaa-soccer-w"===t&&$("#chart2headertext").html("Women&rsquo;s College Soccer"),"ncaa-volleyball-w"===t&&$("#chart2headertext").html("Women&rsquo;s College Volleyball"),d3.selectAll(".c2remove").remove(),"ncaa"!=t)var n=[t];if("ncaa"===t)var n=e;a(t,n,o),r(c,t,n,o,!1)})}}function a(t,e,a){function r(t){$("#c2city").text(c[t].city+", "+c[t].stateAbb),$("#c2numTitles").text(c[t].count),$("#c2numTeams").text(parseCoord(c[t].teams).length),d3.selectAll(".c2winListRow").remove();for(var e=0;e<parseCoord(c[t].teams).length;e++){var a=d3.select("#c2winList").append("div").attr("class","c2winListRow").text(parseCoord(c[t].teams)[e]);a.text().includes("MLB")&&a.style("color",cLeagues.mlb),a.text().includes("NBA")&&a.style("color",cLeagues.nba),a.text().includes("NFL")&&a.style("color",cLeagues.nfl),a.text().includes("NHL")&&a.style("color",cLeagues.nhl),a.text().includes("MLS")&&a.style("color",cLeagues.mls),a.text().includes("CFL")&&a.style("color",cLeagues.cfl),a.text().includes("NCAA")&&a.style("color",cLeagues.ncaa)}}var c;c=a.sort(function(e,a){return d3.descending(+e[t],+a[t])}).slice(0,10),r(0);var s=d3.max(c,function(e){return+e[t]});l=d3.scaleLinear().domain([0,64]);for(var i=0;i<c.length;i++){var d=d3.select(".chart2left").append("div").attr("class","c2remove chart2row chart2rowMain").attr("id","row"+i);d.on("mouseover",function(){d3.selectAll(".chart2rowMain").style("background-color","#333"),d3.select(this).style("background-color","#444"),r(d3.select(this).attr("id").replace("row",""))}),n=15,o=$(".chart2row").width()-160,l.range([1,o-15]);var p=i+1;i>0&&c[i][t]===c[i-1][t]&&(p=i),i>2&&c[i][t]===c[i-2][t]&&(p=i-1),i>4&&c[i][t]===c[i-3][t]&&(p=i-2),i>4&&c[i][t]===c[i-4][t]&&(p=i-3),d.append("div").attr("class","c2remove chart2rank").text(p),d.append("div").attr("class","c2remove chart2city").text(c[i].city+", "+c[i].stateAbb);for(var m=d.append("svg").attr("class","c2remove chart2svg").attr("height",n).attr("width",o),u=0;u<e.length;u++){for(var y=0,h=0;h<u;h++)c[i][e[h]]>0&&(y+=l(c[i][e[h]]));if(c[i][e[u]]>0){m.append("rect").attr("class","c2rect c2remove").attr("id","c2text"+camelize(c[i].city)+"-"+camelize(e[u])).attr("x",y).attr("y",3).attr("height",n-3).attr("width",l(c[i][e[u]]-1)).style("fill","#333").style("stroke",function(){return"ncaa"===t?cLeagues.ncaa:cLeagues[e[u]]}).style("stroke-width",2).style("opacity",0).on("mouseover",function(t,e){d3.select(this).style("opacity",1),d3.selectAll("."+$(this).attr("id")).style("opacity",1)}).on("mouseout",function(){d3.select(this).style("opacity",0),d3.selectAll("."+$(this).attr("id")).style("opacity",0)});for(var f=0;f<c[i][e[u]];f++)m.append("rect").attr("class","c2ticks c2remove").attr("x",y+l(f)-2).attr("y",3).attr("width",2).attr("height",n-3).style("fill",function(){return"ncaa"===t?cLeagues.ncaa:cLeagues[e[u]]});e.length>1&&(m.append("text").attr("class","c2text c2remove chart2label c2text"+camelize(c[i].city)+"-"+camelize(e[u])).attr("x",y).attr("y",0).attr("dy",-3).attr("dx",0).text(c[i][e[u]]+" ("+e[u]+")").style("fill","none").style("stroke","#333").style("stroke-width",4).style("stroke-linejoin","round").style("opacity",0),m.append("text").attr("class","c2text c2remove chart2label c2text"+camelize(c[i].city)+"-"+camelize(e[u])).attr("x",y).attr("y",0).attr("dy",-3).attr("dx",0).text(c[i][e[u]]+" ("+e[u]+")").style("fill","#efefef").style("opacity",0))}}m.append("text").attr("class","c2remove chart2label").attr("x",l(c[i][t])).attr("y",3).attr("dy",9).attr("dx",7).text(c[i][t]).style("fill","#efefef")}}function r(t,e,a,r,c){d3.selectAll(".lastRemove").remove();var i=r.filter(function(e){return camelize(e.city+", "+e.stateAbb)===camelize(t)});if(!c&&($("#c2city").text(i[0].city+", "+i[0].stateAbb),$("#c2numTitles").text(i[0].count),d3.selectAll(".c2winListRow").remove(),void 0!=parseCoord(i[0].teams))){$("#c2numTeams").text(parseCoord(i[0].teams).length);for(var d=0;d<parseCoord(i[0].teams).length;d++){var p=d3.select("#c2winList").append("div").attr("class","c2winListRow").text(parseCoord(i[0].teams)[d]);p.text().includes("MLB")&&p.style("color",cLeagues.mlb),p.text().includes("NBA")&&p.style("color",cLeagues.nba),p.text().includes("NFL")&&p.style("color",cLeagues.nfl),p.text().includes("NHL")&&p.style("color",cLeagues.nhl),p.text().includes("MLS")&&p.style("color",cLeagues.mls),p.text().includes("CFL")&&p.style("color",cLeagues.cfl),p.text().includes("NCAA")&&p.style("color",cLeagues.ncaa)}}var m=d3.select(".chart2left").append("div").attr("class","lastRemove chart2row c2remove chart2lastrow");m.append("div").attr("class","lastRemove c2remove chart2rank").html('<i id="searchsubmit" class="fas fa-search"></i>'),m.append("div").attr("class","lastRemove c2remove chart2city").html('<input type="text" id="search-bar" class="search-bar" placeholder="'+i[0].city+", "+i[0].stateAbb+'" />');var u=m.append("svg").attr("class","lastRemove c2remove chart2svg").attr("height",n).attr("width",o);$("#search-bar").easyAutocomplete(s);for(var y=0;y<a.length;y++){for(var h=0,f=0;f<y;f++)i[0][a[f]]>0&&(h+=l(i[0][a[f]]));if(i[0][a[y]]>0){u.append("rect").attr("class","c2rect c2remove").attr("id","c2text"+camelize(i[0].city)+"-"+camelize(a[y])).attr("x",h).attr("y",3).attr("height",n-3).attr("width",l(i[0][a[y]]-1)).style("fill","#333").style("stroke",function(){return"ncaa"===e?cLeagues.ncaa:cLeagues[a[y]]}).style("stroke-width",2).style("opacity",0).on("mouseover",function(t,e){d3.select(this).style("opacity",1),d3.selectAll("."+$(this).attr("id")).style("opacity",1)}).on("mouseout",function(){d3.select(this).style("opacity",0),d3.selectAll("."+$(this).attr("id")).style("opacity",0)});for(var x=0;x<i[0][a[y]];x++)u.append("rect").attr("class","c2ticks c2remove").attr("x",h+l(x)-2).attr("y",3).attr("width",2).attr("height",n-3).style("fill",function(){return"ncaa"===e?cLeagues.ncaa:cLeagues[a[y]]});a.length>1&&(u.append("text").attr("class","c2text c2remove chart2label c2text"+camelize(i[0].city)+"-"+camelize(a[y])).attr("x",h).attr("y",0).attr("dy",0).attr("dx",0).text(i[0][a[y]]+" ("+a[y]+")").style("fill","none").style("stroke","#444").style("stroke-width",4).style("opacity",0),u.append("text").attr("class","c2text c2remove chart2label c2text"+camelize(i[0].city)+"-"+camelize(a[y])).attr("x",h).attr("y",0).attr("dy",0).attr("dx",0).text(i[0][a[y]]+" ("+a[y]+")").style("fill","#efefef").style("opacity",0))}}u.append("text").attr("class","c2remove chart2label").attr("x",l(i[0][e])).attr("y",3).attr("dy",9).attr("dx",7).text(i[0][e]).style("fill","#efefef")}var o,n,l,c;t.forEach(function(t){searchArray.push(t.city+", "+t.stateAbb)});var s={data:searchArray,list:{maxNumberOfElements:5,sort:{enabled:!0},match:{enabled:!0},onClickEvent:function(){c=$("#search-bar").val(),r(c,i,d[i],t,!1)},onKeyEnterEvent:function(){c=$("#search-bar").val(),r(c,i,d[i],t,!1)}}},i="count",d={count:["mlb","nba","nfl","nhl","mls","cfl","ncaa"],pro:["mlb","nba","nfl","nhl","mls","cfl"],ncaa:["ncaa-baseball-m","ncaa-basketball-m","ncaa-basketball-w","ncaa-football-m","ncaa-soccer-w","ncaa-volleyball-w"]},p={professional:["MLB","NBA","NFL","NHL","MLS","CFL"],college:["Baseball (M)","Basketball (M)","Basketball (W)","Football (M)","Soccer (W)","Volleyball (W)"]};c=void 0!=userPlace?userPlace.city+", "+userPlace.stateAbb:"Minneapolis, MN",a(i,d[i],t),r(c,i,d[i],t,!0),$(".c2option").click(function(){$(".c2option").removeClass("c2optionActive"),$(this).addClass("c2optionActive"),i=$(this).attr("key"),"count"===i&&$("#chart2headertext").text("Sports"),"pro"===i&&$("#chart2headertext").text("Pro Sports"),"ncaa"===i&&$("#chart2headertext").text("College Sports"),d3.selectAll(".c2remove").remove(),d3.selectAll(".c2subfilter").remove(),e(i,d[i],t),a(i,d[i],t),r(c,i,d[i],t,!0)})}function camelize(t){return t.replace(/[.,\/#!$%\^&\*;:{}=\-_`~()]/g,"").replace(/(?:^\w|[A-Z]|\b\w)/g,function(t,e){return 0==e?t.toLowerCase():t.toUpperCase()}).replace(/\s+/g,"")}function countThis(t,e){var a=-1,r=-1;do{a++,r=t.indexOf(e,r+1)}while(r>=0);return a}function parseCoord(t){return JSON.parse("["+t+"]")[0]}function Deg2Rad(t){return t*Math.PI/180}function PythagorasEquirectangular(t,e,a,r){t=Deg2Rad(t),a=Deg2Rad(a),e=Deg2Rad(e),r=Deg2Rad(r);var o=(r-e)*Math.cos((t+a)/2),n=a-t;return 6371*Math.sqrt(o*o+n*n)}function ipLookUp(){$.ajax("http://ip-api.com/json").then(function t(e){userCoord.push(e.lat,e.lon)})}function findClosest(t){var e=99999,a;for(i=0;i<t.length;++i){var r=PythagorasEquirectangular(userCoord[0],userCoord[1],t[i].Latitude,t[i].Longitude);r<e&&(a=i,e=r)}userPlace=t[a]}function getRandomInt(t,e){return Math.floor(Math.random()*(e-t+1))+t}var container=d3.select("#scroll"),graphic=container.select(".scroll__graphic"),chart=graphic.select(".chartmap0"),text=container.select(".scroll__text"),step=text.selectAll(".step"),stepheight,bodyWidth,textWidth,graphicWidth,chartMargin,chartWidth,chartHeight,scroller=scrollama();d3.select(".title-wrapper").style("background-image","url('./img/backgrounds/"+getRandomInt(1,7)+".jpg')");var cLeagues={mlb:"#beaed4",cfl:"#7fc97f",mls:"#fdc086",nba:"#ffff99",nfl:"#f0027f",nhl:"#bf5b17",ncaa:"#386cb0","ncaa-baseball-m":"#386cb0","ncaa-basketball-m":"#386cb0","ncaa-basketball-w":"#386cb0","ncaa-football-m":"#386cb0","ncaa-soccer-w":"#386cb0","ncaa-volleyball-w":"#386cb0"},margin={top:0,right:0,bottom:0,left:0},mapD={w:0,h:0,m:8},smallmapD={w:0,h:0,m:8},mediummapD={w:0,h:0,m:8},c1m={top:12,right:25,bottom:30,left:25},c1D={w:0,h:0,m:8},sliderD={h:$("#slider").height(),w:$("#slider").width()},mapCount=1,smallmapCount=4,mediummapCount=2,userCoord=[],userPlace,searchArray=[],large_screen=!1,medium_screen=!1,small_screen=!1,map0=!1,startDate=new Date(1870,0,1),endDate=new Date(2018,11,31),windowW,windowH,projection,path,smallprojectio,smallpath,mediumprojection,mediumpath,line,targetValue,x,trophyList=["NBA","NHL","NFL","MLB","CFL","MLS","volleyball-w","baseball-m","basketball-w","basketball-m","football-m","soccer-w"],leagueList=["MLB","NBA","NFL","NHL"],levelList=["pro","NCAA"],opacityScale=d3.scaleLinear().domain([1,64]).range([.25,.05]),formatDateIntoYear=d3.timeFormat("%Y"),formatDate=d3.timeFormat("%b %Y"),formatYear=d3.timeFormat("%Y"),parseYear=d3.timeParse("%Y"),parseDate=d3.timeParse("%m/%d/%y"),parseTime=d3.timeParse("%Y%m%d"),x=d3.scaleTime(),xscale=d3.scaleTime().range([0,c1D.w]),yscale=d3.scaleLinear().range([c1D.h,0]);loadData(),d3.selection.prototype.moveToFront=function(){return this.each(function(){this.parentNode.appendChild(this)})},d3.selection.prototype.moveToBack=function(){return this.each(function(){var t=this.parentNode.firstChild;t&&this.parentNode.insertBefore(this,t)})};